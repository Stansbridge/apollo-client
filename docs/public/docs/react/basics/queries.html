<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <!-- Basic -->
    <title>Queries | Apollo Client Guide</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="images/favicon.png" sizes="16x16 32x32 64x64">

    <!-- Social -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://www.apollographql.com/docs/react">
    <meta property="og:title" content="Queries | Apollo Client Guide">
    <meta property="og:description" content="">
    <meta property="og:image" content="">
    <meta name="twitter:card" content="summary_image_large">
    <meta name="twitter:site" content="@apollographql">
    <meta name="twitter:title" content="Queries | Apollo Client Guide">
    <meta name="twitter:description" content="">
    <meta name="twitter:image" content="">

    <!-- Misc -->
    <meta name="google-site-verification" content="" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,200,300italic,400italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/docs/react/style/style.css">
  </head>
  <body class="">
    

<div class="nav dark">
  <div class="nav-group">
    <div class="nav-item show-mobile">
      <span class="js-sidebar-toggle ">
        <span class="icon-menu"></span>
      </span>
    </div>
    <div class="nav-item">
      
      <a class="logo-wrapper" href="http://dev.apollodata.com/" title="Apollo Developers"  >
        <img src="../images/logo-apollo-space-left.svg" alt="Apollo" class="logo"/><img src="../images/logo-apollo-subbrands-developers-space.svg" class="logo-subbrand" alt="Developers"/>
      </a>
    </div>
  </div>

  <div class="nav-group right">
    
      
      <div class="nav-item show-desktop false ">
        <a class="link" href="http://dev.apollodata.com/react"  >
          <span>React</span>
        </a>
      </div>
    
      
      <div class="nav-item show-desktop false ">
        <a class="link" href="http://dev.apollodata.com/angular2"  >
          <span>Angular</span>
        </a>
      </div>
    
      
      <div class="nav-item show-desktop false ">
        <a class="link" href="http://dev.apollodata.com/ios"  >
          <span>iOS</span>
        </a>
      </div>
    
      
      <div class="nav-item show-desktop false ">
        <a class="link" href="http://dev.apollodata.com/android"  >
          <span>Android</span>
        </a>
      </div>
    
      
      <div class="nav-item show-desktop false ">
        <a class="link" href="http://dev.apollodata.com/core"  >
          <span>Vanilla JS</span>
        </a>
      </div>
    
      
      <div class="nav-item show-desktop false separator">
        <a class="link" href="http://dev.apollodata.com/tools"  >
          <span>Server</span>
        </a>
      </div>
    
      
      <div class="nav-item show-desktop false ">
        <a class="link" href="https://medium.com/apollo-stack" target=_new >
          <span>Blog</span>
        </a>
      </div>
    
      
      <div class="nav-item show-desktop false ">
        <a class="link" href="http://dev.apollodata.com/community"  >
          <span>Community</span>
        </a>
      </div>
    
  </div>
</div>

<div class="sidebar">
  <div class="panel">
    <div class="panel-item">
      <a class="" href="../http:/dev.apollodata.com/" title="Apollo"  >
        <span>Apollo Developers</span>
      </a>
    </div>
    
      <div class="panel-item "">
        <a class="" href="http://dev.apollodata.com/react"  >
          <span>React</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="http://dev.apollodata.com/angular2"  >
          <span>Angular</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="http://dev.apollodata.com/ios"  >
          <span>iOS</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="http://dev.apollodata.com/android"  >
          <span>Android</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="http://dev.apollodata.com/core"  >
          <span>Vanilla JS</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="http://dev.apollodata.com/tools"  >
          <span>Server</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="https://medium.com/apollo-stack" target=_new >
          <span>Blog</span>
        </a>
      </div>
    
      <div class="panel-item "">
        <a class="" href="http://dev.apollodata.com/community"  >
          <span>Community</span>
        </a>
      </div>
    
  </div>

  <div class="sidebar-content">
    <div class="topcap">
      <span class="title-sidebar">Apollo Client Guide</span>
      
    </div>

    

    <ul class="toc">
      
        <li>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="../index.html" class="sidebar-link ">
                  <span>Apollo Client</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="integrations.html" class="sidebar-link ">
                  <span>View Integrations</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="setup.html" class="sidebar-link ">
                  <span>Setup and options</span>
                </a>
              </li>
            
              
              <li class="item-toc  current">
                <a href="" class="sidebar-link  current">
                  <span>Queries</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="mutations.html" class="sidebar-link ">
                  <span>Mutations</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="network-layer.html" class="sidebar-link ">
                  <span>Network layer</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="error-handling.html" class="sidebar-link ">
                  <span>Error Handling</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="fragments.html" class="sidebar-link ">
                  <span>Using Fragments</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="subscriptions.html" class="sidebar-link ">
                  <span>Subscriptions</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Features</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="../features/changelog.html" class="sidebar-link ">
                  <span>Changelog</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../features/caching.html" class="sidebar-link ">
                  <span>Direct Cache Access</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../features/developer-tooling.html" class="sidebar-link ">
                  <span>Developer tools</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../features/network-customization.html" class="sidebar-link ">
                  <span></span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../features/optimistic-ui.html" class="sidebar-link ">
                  <span>Optimistic UI</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../features/react-native.html" class="sidebar-link ">
                  <span>Integrating with React Native</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../features/static-typing.html" class="sidebar-link ">
                  <span>Using TypeScript and Flow</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Recipes</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="../recipes/authentication.html" class="sidebar-link ">
                  <span>Authentication</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../recipes/babel.html" class="sidebar-link ">
                  <span>Precompilation with babel</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../recipes/meteor.html" class="sidebar-link ">
                  <span>Meteor</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../recipes/pagination.html" class="sidebar-link ">
                  <span>Pagination</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../recipes/prefetching.html" class="sidebar-link ">
                  <span>Prefetching data</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../recipes/query-splitting.html" class="sidebar-link ">
                  <span>Query Splitting</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../recipes/server-side-rendering.html" class="sidebar-link ">
                  <span>Server Side Rendering</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../recipes/simple-example.html" class="sidebar-link ">
                  <span>Small Example: Snack</span>
                </a>
              </li>
            
              
              <li class="item-toc ">
                <a href="../recipes/webpack.html" class="sidebar-link ">
                  <span>Webpack loader</span>
                </a>
              </li>
            
          </ul>
        </li>
      
        <li>
          
            <div class="heading-toc">Reference</div>
          
          <ul class="list-toc">
            
              
              <li class="item-toc ">
                <a href="../reference/index.html" class="sidebar-link ">
                  <span>Title</span>
                </a>
              </li>
            
          </ul>
        </li>
      
    </ul>
  </div>
</div>

<div class="content">
  <div class="content-wrapper">
    <div class="header-content">
      <h1 class="title-page">Queries</h1>
      

      <div class="page-actions">
        <div class="actions-group">
          <a class="btn tertiary small round lowercase" href="https://github.com/apollographql/apollo-client/tree/master/docs/source/basics/queries.md" target="_blank"><span class="icon-github"></span> <span>Edit on GitHub</span></a>
          
          
        </div>
      </div>
    </div>

    <div class="document-formatting">
      <p>On this page, you can learn how to use Apollo Client to attach GraphQL query results to your React UI. This guide assumes some familiarity with GraphQL itself. You can read about GraphQL queries themselves in detail at <a href="http://graphql.org/docs/queries/" target="_blank" rel="external">graphql.org</a>.</p>
<p>One of our core values is “it’s just GraphQL”. When using Apollo Client, you don’t have to learn anything special about the query syntax, since everything is just standard GraphQL. Anything you can type into the GraphiQL query IDE, you can also put into your Apollo Client code.</p>
<h2 id="basics">Basic queries</h2>

<p>When we are running a basic query we can use the <code>graphql</code> container in a very simple way. We simply parse our query using the <code>gql</code> template literal and then pass it into the <code>graphql</code> container as the first argument.</p>
<p>For instance, in <a href="LINK PLZ">GitHunt</a>, we want to display the currently logged-in user in the <code>Profile</code> component:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; graphql &#125; <span class="keyword">from</span> <span class="string">'react-apollo'</span>;</div><div class="line"><span class="keyword">import</span> gql <span class="keyword">from</span> <span class="string">'graphql-tag'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123; ... &#125;</div><div class="line"></div><div class="line"><span class="comment">// We use the gql tag to parse our query string into a query document</span></div><div class="line"><span class="keyword">const</span> CurrentUserForLayout = gql<span class="string">`</span></div><div class="line"><span class="string">  query CurrentUserForLayout &#123;</span></div><div class="line"><span class="string">    currentUser &#123;</span></div><div class="line"><span class="string">      login</span></div><div class="line"><span class="string">      avatar_url</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">  &#125;</span></div><div class="line"><span class="string">`</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> ProfileWithData = graphql(CurrentUserForLayout)(Profile);</div></pre></td></tr></table></figure>
<p>When we use <code>graphql</code> with a GraphQL query document, two things happen:</p>
<ol>
<li>The query is loaded from the Apollo client-side data store, or the server if the data is not in the store</li>
<li>Our component subscribes to the store, so that it is updated if the data changes as the result of a mutation or some other response from the server</li>
</ol>
<p>In addition to the <code>currentUser</code> field selected in the query, the <code>data</code> prop also includes a field called <code>loading</code>, a Boolean value indicating if the query is currently being loaded from the server, and a field called <code>error</code> to indicate if there was an error fetching the data. So if we were to look at the shape of the props, it would look like this:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">(props) =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> loading = props.data.loading;</div><div class="line">    <span class="keyword">const</span> error = props.data.error;</div><div class="line">    <span class="keyword">const</span> currentUser = props.data.currentUser;</div><div class="line">    <span class="comment">// render UI with loading, error, or currentUser</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The <code>data.currentUser</code> prop will change as what the client knows about the current user changes over time. That information is stored in Apollo Client’s global cache, so if some other query fetches new information about the current user, this component will update to remain consistent. You can read more about techniques to bring the cache up to date with the server in the <a href="LINK PLZ">article about cache updates</a>.</p>
<h2 id="default-result-props" title="The data prop">The structure of the <code>data</code> prop</h2>

<p>As seen above, <code>graphql</code> will pass the result of the query to the wrapped component in a prop called <code>data</code>. It will also pass through all of the props of the parent container.</p>
<p>For queries, the shape of the <code>data</code> prop is the following:</p>
<ul>
<li><code>...fields</code>: One key for each root field in the query.</li>
<li><code>loading</code>: This field is <code>true</code> if there is currently a query fetch in flight, including after calling <code>refetch</code>. <code>false</code> otherwise.</li>
<li><code>error</code>: An ApolloError object that represents the different possible errors that might happen when running a query.</li>
</ul>
<p>There are a lot more methods as well, which you can read about <a href="#graphql-query-data">in the API docs for queries</a>. As an example, for a query like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">query getUserAndLikes($id: ID!) &#123;</div><div class="line">  user(userId: $id) &#123; name &#125;</div><div class="line">  likes(userId: $id) &#123; count &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>You could get props like:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">data: &#123;</div><div class="line">  user: &#123; <span class="attr">name</span>: <span class="string">"James"</span> &#125;,</div><div class="line">  likes: &#123; <span class="attr">count</span>: <span class="number">10</span> &#125;,</div><div class="line">  loading: <span class="literal">false</span>,</div><div class="line">  error: <span class="literal">null</span>,</div><div class="line">  variables: &#123; <span class="attr">id</span>: <span class="string">'asdf'</span> &#125;,</div><div class="line">  refetch() &#123; ... &#125;,</div><div class="line">  fetchMore() &#123; ... &#125;,</div><div class="line">  startPolling() &#123; ... &#125;,</div><div class="line">  stopPolling() &#123; ... &#125;,</div><div class="line">  <span class="comment">// ... more methods</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>If you use the <code>props</code> option to the wrapper to specify <a href="#graphql-props">custom <code>props</code></a> for your child component, this object will be passed to the <code>props</code> option on the parameter named <code>data</code>.</p>
<h2 id="graphql-options">Variables and options</h2>

<p>If you want to configure the query, you can provide an <code>options</code> key on the second argument to <code>graphql</code>, and your options will be passed along to <a href="#watchQuery"><code>ApolloClient.watchQuery</code></a>. If your query requires variables, this is the place to pass them in:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Suppose our profile query took an avatar size</span></div><div class="line"><span class="keyword">const</span> CurrentUserForLayout = gql<span class="string">`</span></div><div class="line"><span class="string">  query CurrentUserForLayout($avatarSize: Int!) &#123;</span></div><div class="line"><span class="string">    currentUser &#123;</span></div><div class="line"><span class="string">      login</span></div><div class="line"><span class="string">      avatar_url(avatarSize: $avatarSize)</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">  &#125;</span></div><div class="line"><span class="string">`</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> ProfileWithData = graphql(CurrentUserForLayout, &#123;</div><div class="line">  options: &#123; <span class="attr">variables</span>: &#123; <span class="attr">avatarSize</span>: <span class="number">100</span> &#125; &#125;,</div><div class="line">&#125;)(Profile);</div></pre></td></tr></table></figure>
<h2 id="options-from-props">Computing from props</h2>

<p>Typically, variables to the query will be computed from the <code>props</code> of the wrapper component. Wherever the component is used in your application, the caller would pass arguments. So <code>options</code> can be a function that takes the props passed into the component:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// The caller could do something like:</span></div><div class="line">&lt;ProfileWithData avatarSize=&#123;<span class="number">300</span>&#125; /&gt;</div><div class="line"></div><div class="line"><span class="comment">// And our HOC could look like:</span></div><div class="line"><span class="keyword">const</span> ProfileWithData = graphql(CurrentUserForLayout, &#123;</div><div class="line">  options: <span class="function">(<span class="params">&#123; avatarSize &#125;</span>) =&gt;</span> (&#123; <span class="attr">variables</span>: &#123; avatarSize &#125; &#125;),</div><div class="line">&#125;)(Profile);</div></pre></td></tr></table></figure>
<p>By default, <code>graphql</code> will attempt to pick up any missing variables from the query from <code>ownProps</code>. So in our example above, we could have used the simpler <code>graphql(CurrentUserForLayout)(Profile);</code>. However, if you need to change the name of a variable, compute the value, or just want to be more explicit about things, the <code>options</code> function is the place to do it.</p>
<h2 id="other-graphql-options">Other options</h2>

<p>There are a lot of other options you can pass in other than just <code>variables</code>, for example <code>pollInterval</code>:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> ProfileWithData = graphql(CurrentUserForLayout, &#123;</div><div class="line">  <span class="comment">// See the watchQuery API for the options you can provide here</span></div><div class="line">  options: &#123; <span class="attr">pollInterval</span>: <span class="number">20000</span> &#125;,</div><div class="line">&#125;)(Profile);</div></pre></td></tr></table></figure>
<p>If you use a function to compute options from props, all of these <code>options</code> will be automatically recalculated whenever the props change.</p>
<p><a href="api-queries.html#graphql-query-options">Read about all of the query options in the API documentation.</a></p>
<h2 id="graphql-skip">Skipping an operation</h2>

<p>The <code>graphql</code> container API is intentionally fully static, so you can’t dynamically change the query or wrapped component at runtime without generating a new React component. However, sometimes you may want to do some conditional logic to skip a query based on the passed in props. To do this you can use the <code>skip</code> config.</p>
<p>For example, you could use this if you want to ignore a query if a user isn’t authenticated:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> ProfileWithData = graphql(CurrentUserForLayout, &#123;</div><div class="line">  skip: <span class="function">(<span class="params">ownProps</span>) =&gt;</span> !ownProps.authenticated,</div><div class="line">&#125;)(Profile);</div></pre></td></tr></table></figure>
<p><code>skip</code> can also be a static property:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> ProfileWithData = graphql(CurrentUserForLayout, &#123;</div><div class="line">  skip: <span class="literal">true</span>,</div><div class="line">&#125;)(Profile);</div></pre></td></tr></table></figure>
<p>Passing the <code>skip</code> config completely bypasses the higher-order component, as if it weren’t there at all. This means your child component doesn’t get a <code>data</code> prop at all, and the <code>options</code> or <code>props</code> methods are not called.</p>
<h2 id="graphql-props">Controlling child props</h2>

<p>By default, <code>graphql</code> used with a query will provide a <code>data</code> prop to the wrapped component with various information about the state of the query. We’ll also see that <a href="mutations.html">mutations</a> provide a callback on the <code>mutate</code> prop. It’s possible to write your whole app just using these default prop names.</p>
<p>However, if you want to decouple your UI components from Apollo and make them more reusable in different contexts, you may want to modify these default props and wrap them with your own custom objects and functions.</p>
<h2 id="graphql-name">Changing the prop name</h2>

<p>If you want to change the name of the default <code>data</code> prop, but keep the exact same shape, you can use <code>name</code> option to the <code>graphql</code> container. This is especially useful when one component is using multiple queries via nested <code>graphql</code> containers, where the <code>data</code> prop would otherwise be overwritten.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; graphql &#125; <span class="keyword">from</span> <span class="string">'react-apollo'</span>;</div><div class="line"><span class="keyword">import</span> gql <span class="keyword">from</span> <span class="string">'graphql-tag'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123; ... &#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> CurrentUserForLayout = gql<span class="string">`</span></div><div class="line"><span class="string">  query CurrentUserForLayout &#123;</span></div><div class="line"><span class="string">    currentUser &#123;</span></div><div class="line"><span class="string">      login</span></div><div class="line"><span class="string">      avatar_url</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">  &#125;</span></div><div class="line"><span class="string">`</span>;</div><div class="line"></div><div class="line"><span class="comment">// We want the prop to be called 'CurrentUserForLayout' instead of data</span></div><div class="line"><span class="keyword">const</span> ProfileWithData = graphql(CurrentUserForLayout, &#123;</div><div class="line">  name: <span class="string">'CurrentUserForLayout'</span></div><div class="line">&#125;)(Profile);</div></pre></td></tr></table></figure>
<h2 id="graphql-props-option">Arbitrary transformation</h2>

<p>If you want complete control over the props of the child component, use the <code>props</code> option to map the query <code>data</code> object into any number of props that will be passed into the child:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> &#123; graphql &#125; <span class="keyword">from</span> <span class="string">'react-apollo'</span>;</div><div class="line"><span class="keyword">import</span> gql <span class="keyword">from</span> <span class="string">'graphql-tag'</span>;</div><div class="line"></div><div class="line"><span class="comment">// Here Profile has a more generic API, that's not coupled to Apollo or the</span></div><div class="line"><span class="comment">// shape of the query that we've used</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Profile</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123; ... &#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> CurrentUserForLayout = gql<span class="string">`</span></div><div class="line"><span class="string">  query CurrentUserForLayout &#123;</span></div><div class="line"><span class="string">    currentUser &#123;</span></div><div class="line"><span class="string">      login</span></div><div class="line"><span class="string">      avatar_url</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">  &#125;</span></div><div class="line"><span class="string">`</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> ProfileWithData = graphql(CurrentUserForLayout, &#123;</div><div class="line">  <span class="comment">// ownProps are the props that are passed into the `ProfileWithData`</span></div><div class="line">  <span class="comment">// when it is used by a parent component</span></div><div class="line">  props: <span class="function">(<span class="params">&#123; ownProps, data: &#123; loading, currentUser, refetch &#125; &#125;</span>) =&gt;</span> (&#123;</div><div class="line">    userLoading: loading,</div><div class="line">    user: currentUser,</div><div class="line">    refetchUser: refetch,</div><div class="line">  &#125;),</div><div class="line">&#125;)(Profile);</div></pre></td></tr></table></figure>
<p>This style of usage leads to the greatest decoupling between your presentational component (<code>Profile</code>) and Apollo.</p>
<h2 title="API">API Reference</h2>

<h3 id="graphql-query-data"><code>props.data</code></h3>

<p>The higher-order component created when using <code>graphql()</code> will feed a <code>data</code> prop into your component. Like so:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">render() &#123;</div><div class="line">  <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">this</span>.props; <span class="comment">// &lt;- The `data` prop.</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The <code>data</code> prop contains the data fetched from your query in addition to some other useful information and functions to control the lifecycle of your GraphQL-connected component. So for example, if we had a query that looked like:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  viewer &#123; name &#125;</div><div class="line">  todos &#123; text &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Your <code>data</code> prop would contain that data:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">render() &#123;</div><div class="line">  <span class="keyword">const</span> &#123; data &#125; = <span class="keyword">this</span>.props;</div><div class="line"></div><div class="line">  <span class="built_in">console</span>.log(data.viewer); <span class="comment">// &lt;- The data returned by your query for `viewer`.</span></div><div class="line">  <span class="built_in">console</span>.log(data.todos); <span class="comment">// &lt;- The data returned by your query for `todos`.</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The <code>data</code> prop has some other useful properties which can be accessed directly from <code>data</code>. For example, <code>data.loading</code> or <code>data.error</code>. These properties are documented below.</p>
<p>Make sure to always check <code>data.loading</code> and <code>data.error</code> in your components before rendering. Properties like <code>data.todos</code> which contain your app’s data may be undefined while your component is performing its initial fetch. Checking <code>data.loading</code> and <code>data.error</code> helps you avoid any issues with undefined data. Such checks may look like:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">render() &#123;</div><div class="line">  <span class="keyword">const</span> &#123; <span class="attr">data</span>: &#123; loading, error, todos &#125; &#125; = <span class="keyword">this</span>.props;</div><div class="line">  <span class="keyword">if</span> (loading) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (error) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Error!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;ul&gt;</div><div class="line">        &#123;todos.map(<span class="function">(<span class="params">&#123; id, text &#125;</span>) =&gt;</span> (</div><div class="line">          &lt;li key=&#123;id&#125;&gt;&#123;text&#125;&lt;<span class="regexp">/li&gt;</span></div><div class="line"><span class="regexp">        ))&#125;</span></div><div class="line"><span class="regexp">      &lt;/u</span>l&gt;</div><div class="line">    );</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="graphql-query-data-loading"><code>data.loading</code></h3>

<p>A boolean representing whether or not a query request is currently in flight for this component. This means that a query request has been sent using your network interface, and we have not yet gotten a response back. Use this property to render a loading component.</p>
<p>However, just because <code>data.loading</code> is true it does not mean that you won’t have data. For instance, if you already have <code>data.todos</code>, but you want to get the latest todos from your API <code>data.loading</code> might be true, but you will still have the todos from your previous request.</p>
<p>There are multiple different network states that your query may be in. If you want to see what the network state of your component is in more detail then refer to <a href="#graphql-query-data-networkStatus"><code>data.networkStatus</code></a>.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params">&#123; data: &#123; loading &#125; &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (loading) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`query &#123; ... &#125;`</span>)(MyComponent);</div></pre></td></tr></table></figure>
<h3 id="graphql-query-data-error"><code>data.error</code></h3>

<p>If an error occurred then this property will be an instance of <a href="/docs/core/error-handling.html#ApolloError"><code>ApolloError</code></a>. If you do not handle this error you will get a warning in your console that says something like: <code>&quot;Unhandled (in react-apollo) Error: ...&quot;</code>.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params">&#123; data: &#123; error &#125; &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (error) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Error!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`query &#123; ... &#125;`</span>)(MyComponent);</div></pre></td></tr></table></figure>
<h3 id="graphql-query-data-networkStatus"><code>data.networkStatus</code></h3>

<p><code>data.networkStatus</code> is useful if you want to display a different loading indicator (or no indicator at all) depending on your network status as it provides a more detailed view into the state of a network request on your component than <a href="#graphql-query-data-loading"><code>data.loading</code></a> does. <code>data.networkStatus</code> is an enum with different number values between 1 and 8. These number values each represent a different network state.</p>
<ol>
<li><code>loading</code>: The query has never been run before and the request is now pending. A query will still have this network status even if a result was returned from the cache, but a query was dispatched anyway.</li>
<li><code>setVariables</code>: If a query’s variables change and a network request was fired then the network status will be <code>setVariables</code> until the result of that query comes back. React users will see this when <a href="#graphql-query-options-variables"><code>options.variables</code></a> changes on their queries.</li>
<li><code>fetchMore</code>: Indicates that <code>fetchMore</code> was called on this query and that the network request created is currently in flight.</li>
<li><code>refetch</code>: It means that <code>refetch</code> was called on a query and the refetch request is currently in flight.</li>
<li>Unused.</li>
<li><code>poll</code>: Indicates that a polling query is currently in flight. So for example if you are polling a query every 10 seconds then the network status will switch to <code>poll</code> every 10 seconds whenever a poll request has been sent but not resolved.</li>
<li><code>ready</code>: No request is in flight for this query, and no errors happened. Everything is OK.</li>
<li><code>error</code>: No request is in flight for this query, but one or more errors were detected.</li>
</ol>
<p>If the network status is less then 7 then it is equivalent to <a href="#graphql-query-data-loading"><code>data.loading</code></a> being true. In fact you could replace all of your <code>data.loading</code> checks with <code>data.networkStatus &lt; 7</code> and you would not see a difference. It is recommended that you use <code>data.loading</code>, however.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params">&#123; data: &#123; networkStatus &#125; &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (networkStatus === <span class="number">6</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Polling!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (networkStatus &lt; <span class="number">7</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`query &#123; ... &#125;`</span>)(MyComponent);</div></pre></td></tr></table></figure>
<h3 id="graphql-query-data-variables"><code>data.variables</code></h3>

<p>The variables that Apollo used to fetch data from your GraphQL endpoint. This property is helpful if you want to render some information based on the variables that were used to make a request against your server.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params">&#123; data: &#123; variables &#125; &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;div&gt;</div><div class="line">      Query executed <span class="keyword">with</span> the following variables:</div><div class="line">      &lt;code&gt;&#123;<span class="built_in">JSON</span>.stringify(variables)&#125;&lt;<span class="regexp">/code&gt;</span></div><div class="line"><span class="regexp">    &lt;/</span>div&gt;</div><div class="line">  );</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`query &#123; ... &#125;`</span>)(MyComponent);</div></pre></td></tr></table></figure>
<h3 id="graphql-query-data-refetch"><code>data.refetch(variables)</code></h3>

<p>Forces your component to refetch the query you defined in the <code>graphql()</code> function. This method is helpful when you want to reload the data in your component, or retry a fetch after an error.</p>
<p><code>data.refetch</code> returns a promise that resolves with the new data fetched from your API once the query has finished executing. The promise will reject if the query failed.</p>
<p>The <code>data.refetch</code> function takes a single <code>variables</code> object argument. The <code>variables</code> argument will replace <code>variables</code> used with either the <code>query</code> option or the query from your <code>graphql()</code> HOC (depending on whether or not you specified a <code>query</code>) option to refetch the query you defined in the <code>graphql()</code> function.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params">&#123; data: &#123; refetch &#125; &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> (</div><div class="line">    &lt;button onClick=&#123;() =&gt; refetch()&#125;&gt;</div><div class="line">      Reload</div><div class="line">    &lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">  );</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default graphql(gql`query &#123; ... &#125;`)(MyComponent);</span></div></pre></td></tr></table></figure>
<h3 id="graphql-query-data-fetchMore"><code>data.fetchMore(options)</code></h3>

<p>The <code>data.fetchMore</code> function allows you to do pagination with your query component. To learn more about pagination with <code>data.fetchMore</code>, be sure to read the <a href="pagination.html">pagination</a> recipe which contains helpful illustrations on how you can do pagination with React Apollo.</p>
<p><code>data.fetchMore</code> returns a promise that resolves once the query executed to fetch more data has resolved.</p>
<p>The <code>data.fetchMore</code> function takes a single <code>options</code> object argument. The <code>options</code> argument may take the following properties:</p>
<ul>
<li><code>[query]</code>: This is an optional GraphQL document created with the <code>gql</code> GraphQL tag. If you specify a <code>query</code> then that query will be fetched when you call <code>data.fetchMore</code>. If you do not specify a <code>query</code>, then the query from your <code>graphql()</code> HOC will be used.</li>
<li><code>[variables]</code>: The optional variables you may provide that will be used with either the <code>query</code> option or the query from your <code>graphql()</code> HOC (depending on whether or not you specified a <code>query</code>).</li>
<li><code>updateQuery(previousResult, { fetchMoreResult, queryVariables })</code>: This is the required function you define that will actually update your paginated list. The first argument, <code>previousResult</code>, will be the previous data returned by the query you defined in your <code>graphql()</code> function. The second argument is an object with two properties, <code>fetchMoreResult</code> and <code>queryVariables</code>. <code>fetchMoreResult</code> is the data returned by the new fetch that used the <code>query</code> and <code>variables</code> options from <code>data.fetchMore</code>. <code>queryVariables</code> are the variables that were used when fetching more data. Using these arguments you should return a new data object with the same shape as the GraphQL query you defined in your <code>graphql()</code> function. See an example of this below, and also make sure to read the <a href="pagination.html">pagination</a> recipe which has a full example.</li>
</ul>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">data.fetchMore(&#123;</div><div class="line">  updateQuery: <span class="function">(<span class="params">previousResult, &#123; fetchMoreResult, queryVariables &#125;</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      ...previousResult,</div><div class="line">      <span class="comment">// Add the new feed data to the end of the old feed data.</span></div><div class="line">      feed: [...previousResult.feed, ...fetchMoreResult.feed],</div><div class="line">    &#125;;</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="graphql-query-data-subscribeToMore"><code>data.subscribeToMore(options)</code></h3>

<p>This function will set up a subscription, triggering updates whenever the server sends a subscription publication. This requires subscriptions to be set up on the server to properly work. Check out the <a href="http://dev.apollodata.com/react/receiving-updates.html#Subscriptions" target="_blank" rel="external">subscriptions guide</a> and the <a href="https://github.com/apollographql/subscriptions-transport-ws" target="_blank" rel="external">subscriptions-transport-ws</a> and <a href="https://github.com/apollographql/graphql-subscriptions" target="_blank" rel="external">graphql-subscriptions</a> for more information on getting this set up.</p>
<p>This function returns an <code>unsubscribe</code> function handler which can be used to unsubscribe later.</p>
<p>A common practice is to wrap the <code>subscribeToMore</code> call within <code>componentWillReceiveProps</code> and perform the subscription after the original query has completed. To ensure the subscription isn’t created multiple times, you can attach it to the component instance. See the example for more details.</p>
<ul>
<li><code>[document]</code>: Document is a required property that accepts a GraphQL subscription created with <code>graphql-tag</code>’s <code>gql</code> template string tag. It should contain a single GraphQL subscription operation with the data that will be returned.</li>
<li><code>[variables]</code>: The optional variables you may provide that will be used with the <code>document</code> option.</li>
<li><code>[updateQuery]</code>: An optional function that runs every time the server sends an update. This modifies the results of the HOC query. The first argument, <code>previousResult</code>, will be the previous data returned by the query you defined in your <code>graphql()</code> function. The second argument is an object with two properties. <code>subscriptionData</code> is result of the subscription. <code>variables</code> is the variables object used with the subscription query. Using these arguments you should return a new data object with the same shape as the GraphQL query you defined in your <code>graphql()</code> function. This is similar to the <a href="#graphql-query-data-fetchMore"><code>fetchMore</code></a> callback. Alternatively, you could update the query using a <a href="http://dev.apollodata.com/react/cache-updates.html#resultReducers" target="_blank" rel="external">reducer</a> as part of the <a href="http://dev.apollodata.com/react/queries.html#graphql-options" target="_blank" rel="external">options</a> of your <code>graphql()</code> function.</li>
<li><code>[onError]</code>: An optional error callback.</li>
</ul>
<p>In order to update the query’s store with the result of the subscription, you must specify either the <code>updateQuery</code> option in <code>subscribeToMore</code> or the <code>reducer</code> option in your <code>graphql()</code> function.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubscriptionComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  componentWillReceiveProps(nextProps) &#123;</div><div class="line">    <span class="keyword">if</span>(!nextProps.data.loading) &#123;</div><div class="line">      <span class="comment">// Check for existing subscription</span></div><div class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.unsubscribe) &#123;</div><div class="line">        <span class="comment">// Check if props have changed and, if necessary, stop the subscription</span></div><div class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.props.subscriptionParam !== nextProps.subscriptionParam) &#123;</div><div class="line">          <span class="keyword">this</span>.unsubscribe();</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="comment">// Subscribe</span></div><div class="line">      <span class="keyword">this</span>.unsubscribe = nextProps.data.subscribeToMore(&#123;</div><div class="line">        <span class="built_in">document</span>: gql<span class="string">`subscription &#123;...&#125;`</span>,</div><div class="line">        updateQuery: <span class="function">(<span class="params">previousResult, &#123; subscriptionData, variables &#125;</span>) =&gt;</span> &#123;</div><div class="line">          <span class="comment">// Perform updates on previousResult with subscriptionData</span></div><div class="line">          <span class="keyword">return</span> updatedResult;</div><div class="line">        &#125;</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="graphql-query-data-startPolling"><code>data.startPolling(interval)</code></h3>

<p>This function will set up an interval and send a fetch request every time that interval ellapses. The function takes only one integer argument which allows you to configure how often you want your query to be executed in milliseconds. In other words, the <code>interval</code> argument represents the milliseconds between polls.</p>
<p>Polling is a good way to keep the data in your UI fresh. By refetching your data every 5,000 milliseconds (or 5 seconds, for example) you may effectively emulate realtime data without needing to build up a realtime backend.</p>
<p>If you call <code>data.startPolling</code> when your query is already polling then the current polling process will be cancelled and a new process will be started with the interval you specified.</p>
<p>You may also use <a href="#graphql-config-options-pollInterval"><code>options.pollInterval</code></a> to start polling immediately after your component mounts. It is recommend that you use <a href="#graphql-config-options-pollInterval"><code>options.pollInterval</code></a> if you don’t need to arbitrarily start and stop polling.</p>
<p>If you set your <code>interval</code> to 0 then that means no polling instead of executing a request every JavaScript event loop tick.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  componentDidMount() &#123;</div><div class="line">    <span class="comment">// In this specific case you may want to use `options.pollInterval` instead.</span></div><div class="line">    <span class="keyword">this</span>.props.data.startPolling(<span class="number">1000</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  render() &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`query &#123; ... &#125;`</span>)(MyComponent);</div></pre></td></tr></table></figure>
<h3 id="graphql-query-data-stopPolling"><code>data.stopPolling()</code></h3>

<p>By calling this function you will stop any current polling process. Your query will not start polling again until you call <code>data.startPolling</code>.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div&gt;</div><div class="line">        &lt;button onClick=&#123;() =&gt; &#123;</div><div class="line">          <span class="keyword">this</span>.props.data.startPolling(<span class="number">1000</span>);</div><div class="line">        &#125;&#125;&gt;</div><div class="line">          Start Polling</div><div class="line">        &lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">        &lt;button onClick=&#123;() =&gt; &#123;</span></div><div class="line"><span class="regexp">          this.props.data.stopPolling();</span></div><div class="line"><span class="regexp">        &#125;&#125;&gt;</span></div><div class="line"><span class="regexp">          Stop Polling</span></div><div class="line"><span class="regexp">        &lt;/</span>button&gt;</div><div class="line">      &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    )</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">export default graphql(gql`query &#123; ... &#125;`)(MyComponent);</span></div></pre></td></tr></table></figure>
<h3 id="graphql-query-data-updateQuery"><code>data.updateQuery(updaterFn)</code></h3>

<p>This function allows you to update the data for your query outside of the context of any mutation, subscription, or fetch. This function only takes a single argument which will be another function. The argument function has the following signature:</p>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(<span class="name">previousResult</span>, &#123; variables &#125;) =&gt; nextResult</div></pre></td></tr></table></figure>
<p>The first argument will be the data for your query that currently exists in the store, and you are expected to return a new data object with the same shape. That new data object will be written to the store and any components tracking that data will be updated reactively.</p>
<p>The second argument is an object with a single property, <code>variables</code>. The <code>variables</code> property allows you to see what variables were used when reading the <code>previousResult</code> from the store.</p>
<p>This method will <em>not</em> update anything on the server. It will only update data in your client cache and if you reload your JavaScript environment then your update will disappear.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data.updateQuery(<span class="function">(<span class="params">previousResult</span>) =&gt;</span> (&#123;</div><div class="line">  ...previousResult,</div><div class="line">  count: previousResult.count + <span class="number">1</span>,</div><div class="line">&#125;));</div></pre></td></tr></table></figure>
<h3 id="graphql-query-options"><code>config.options</code></h3>

<p>An object or function that returns an object of options that are used to configure how the query is fetched and updated.</p>
<p>If <code>config.options</code> is a function then it will take the component’s props as its first argument.</p>
<p>The options available for use  in this object depend on the operation type you pass in as the first argument to <code>graphql()</code>. The references below will document which options are availble when your operation is a query. To see what other options are available for different operations, see the generic documentation for <a href="#graphql-config-options"><code>config.options</code></a>.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`&#123; ... &#125;`</span>, &#123;</div><div class="line">  options: &#123;</div><div class="line">    <span class="comment">// Options go here.</span></div><div class="line">  &#125;,</div><div class="line">&#125;)(MyComponent);</div></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`&#123; ... &#125;`</span>, &#123;</div><div class="line">  options: <span class="function">(<span class="params">props</span>) =&gt;</span> (&#123;</div><div class="line">    <span class="comment">// Options are computed from `props` here.</span></div><div class="line">  &#125;),</div><div class="line">&#125;)(MyComponent);</div></pre></td></tr></table></figure>
<h3 id="graphql-config-options-variables"><code>options.variables</code></h3>

<p>The variables that will be used when executing the query operation. These variables should correspond with the variables that your query definition accepts. If you define <code>config.options</code> as a function then you may compute your variables from your props.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`</span></div><div class="line"><span class="string">  query ($width: Int!, $height: Int!) &#123;</span></div><div class="line"><span class="string">    ...</span></div><div class="line"><span class="string">  &#125;</span></div><div class="line"><span class="string">`</span>, &#123;</div><div class="line">  options: <span class="function">(<span class="params">props</span>) =&gt;</span> (&#123;</div><div class="line">    variables: &#123;</div><div class="line">      width: props.size,</div><div class="line">      height: props.size,</div><div class="line">    &#125;,</div><div class="line">  &#125;),</div><div class="line">&#125;)(MyComponent);</div></pre></td></tr></table></figure>
<h3 id="graphql-config-options-fetchPolicy"><code>options.fetchPolicy</code></h3>

<p>The fetch policy is an option which allows you to specify how you want your component to interact with the Apollo data cache. By default your component will try to read from the cache first, and if the full data for your query is in the cache then Apollo simply returns the data from the cache. If the full data for your query is <em>not</em> in the cache then Apollo will execute your request using your network interface. By changing this option you can change this behavior.</p>
<p>Valid <code>fetchPolicy</code> values are:</p>
<ul>
<li><code>cache-first</code>: This is the default value where we always try reading data from your cache first. If all the data needed to fulfill your query is in the cache then that data will be returned. Apollo will only fetch from the network if a cached result is not available. This fetch policy aims to minimize the number of network requests sent when rendering your component.</li>
<li><code>cache-and-network</code>: This fetch policy will have Apollo first trying to read data from your cache. If all the data needed to fulfill your query is in the cache then that data will be returned. However, regardless of whether or not the full data is in your cache this <code>fetchPolicy</code> will <em>always</em> execute query with the network interface unlike <code>cache-first</code> which will only execute your query if the query data is not in your cache. This fetch policy optimizes for users getting a quick response while also trying to keep cached data consistent with your server data at the cost of extra network requests.</li>
<li><code>network-only</code>: This fetch policy will <em>never</em> return you initial data from the cache. Instead it will always make a request using your network interface to the server. This fetch policy optimizes for data consistency with the server, but at the cost of an instant response to the user when one is available.</li>
<li><code>cache-only</code>: This fetch policy will <em>never</em> execute a query using your network interface. Instead it will always try reading from the cache. If the data for your query does not exist in the cache then an error will be thrown. This fetch policy allows you to only interact with data in your local client cache without making any network requests which keeps your component fast, but means your local data might not be consistent with what is on the server. If you are interested in only interacting with data in your Apollo Client cache also be sure to look at the <a href="cache#ApolloClient.readQuery"><code>readQuery()</code></a> and <a href="cache#ApolloClient.readFragment"><code>readFragment()</code></a> methods available to you on your <a href="/docs/react"><code>ApolloClient</code></a> instance.</li>
</ul>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`query &#123; ... &#125;`</span>, &#123;</div><div class="line">  options: &#123; <span class="attr">fetchPolicy</span>: <span class="string">'cache-and-network'</span> &#125;,</div><div class="line">&#125;)(MyComponent);</div></pre></td></tr></table></figure>
<h3 id="graphql-config-options-pollInterval"><code>options.pollInterval</code></h3>

<p>The interval in milliseconds at which you want to start polling. Whenever that number of milliseconds elapses your query will be executed using the network interface and another execution will be scheduled using the configured number of milliseconds.</p>
<p>This option will start polling your query immediately when the component mounts. If you want to start and stop polling dynamically then you may use <a href="#graphql-query-data-startPolling"><code>data.stopPolling</code></a> and <a href="#graphql-query-data-stopPolling"><code>data.startPolling</code></a>.</p>
<p>If you set <code>options.pollInterval</code> to 0 then that means no polling instead of executing a request every JavaScript event loop tick.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`query &#123; ... &#125;`</span>, &#123;</div><div class="line">  options: &#123; <span class="attr">pollInterval</span>: <span class="number">5000</span> &#125;,</div><div class="line">&#125;)(MyComponent);</div></pre></td></tr></table></figure>
<h3 id="graphql-config-options-notifyOnNetworkStatusChange"><code>options.notifyOnNetworkStatusChange</code></h3>

<p>Whether or not updates to the network status or network error should trigger re-rendering of your component.</p>
<p>The default value is <code>false</code>.</p>
<p><strong>Example:</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> graphql(gql<span class="string">`query &#123; ... &#125;`</span>, &#123;</div><div class="line">  options: &#123; <span class="attr">notifyOnNetworkStatusChange</span>: <span class="literal">true</span> &#125;,</div><div class="line">&#125;)(MyComponent);</div></pre></td></tr></table></figure>
    </div>
  </div>

  <div class="pagination">
    <div class="content-wrapper">
      
      
        <a class="link primary prev"
          href="setup.html">
          <span class="icon-arrow-left-alt"></span>
          <span class="subtitle-pagination">Previous</span>
          Setup and options
        </a>
      
      
        <a class="link primary next"
          href="mutations.html">
          <span class="subtitle-pagination">Next</span>
          Mutations
          <span class="icon-arrow-right-alt"></span>
        </a>
      
    </div>
  </div>

  <div class="github">
    <a class="link tertiary " href="https://github.com/apollographql/apollo-client/tree/master/docs/source/basics/queries.md" target="_blank">
      <span class="icon-github"></span>Edit on GitHub</a>
  </div>

  
</div>

    <script src="/docs/react/script/smooth-scroll.min.js"></script>
    <script src="/docs/react/script/main.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
    <script type="text/javascript" src="//cdn.jsdelivr.net/fastclick/1.0.6/fastclick.min.js"></script>

    <script>
      // nectar ninja
      (function(){
        var handle = '@meteorjs';
        var a = document.createElement('script');
        var m = document.getElementsByTagName('script')[0];
        a.async = 1;
        a.src = 'https://nectar.ninja/api/v1/' + handle.slice(1);
        m.parentNode.insertBefore(a, m);
      })();

     

      
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-PNFDVBB');
      

      
        // Segment Tracking
        !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
        analytics.load("wgrIo8Bul0Ujl8USETG3DB6hONdy4kTg");
        analytics.page()
        }}();
      

      // search box
      

      
    </script>
  </body>
</html>
